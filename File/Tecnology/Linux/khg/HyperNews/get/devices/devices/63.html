
<HTML>
<HEAD>
<TITLE>Timing of slow I/O / locking of resources</TITLE>
<LINK rel="owner" href="mailto:">
<SCRIPT LANGUAGE="JavaScript">
<!-- hide this

function help(message) {
  self.status = message;
  return true;
}
// stop hiding -->
</SCRIPT>

</HEAD>
<BODY>
<strong>The
<a href="http://www.hypernews.org/HyperNews/get/hypernews.html">
HyperNews <a href="../../khg.html">Linux KHG</a>
Discussion Pages</strong>
<hr>
<NOBR>





</NOBR><BR>
<H2><IMG src="../../../../Icons/question.gif" ALT="Question:"
  WIDTH=15 HEIGHT=15
  ALIGN="bottom">
Timing of slow I/O / locking of resources</H2>

<DL> <DD>
<NOBR>
<font size=+1><I>Forum:</I> <A HREF="../devices.html" >
 Device Drivers</A> </font><BR>
<I>Keywords:</I> slow I/O, scheduling, identification of accesses <BR>
<I>Date:</I> Sat, 14 Mar 1998 06:01:41 GMT <BR>
<I>From:</I> <A HREF="http://www.eleves.ens.fr:8080/home/horvai/" >Horvai Peter</A> &lt;<A HREF="mailto:horvai@ens.fr" >horvai@ens.fr</A>&gt; <BR>

</NOBR>
</DD> </DL>

<P>
<table border cellpadding=5 cellspacing=0 
 width="100%" BGCOLOR="#FFFFFF">
 <tr><td>

I have a few simple questions on writing modules, for which
I didn't find the answer (well, maybe it's still there) in
the khg.
<P>

I need to time out writes to a very slow and primitive device,
I can send a byte per millisecond (_not_ microsecond), and
the device delivers no interrupts and is not pollable. How
should I do the timing?
<P>

Secondly, if I would like to implement a locking policy,
so that procedures having already an open file descriptor
on my device can obtain the lock, I must be able to identify
the different procedures + file-descriptors accessing the driver. I
suppose that this stuff is in the struct file * structure, but
it is unclear to me how exactly this information is coded.
<P>

Finally, returning to the first question, how can I delay
a procedure in driver (kernel) space, can I call usleep(), or
use setitimer(), and may I use schedule() to yield control
for some time if my I/O is really slow, and continue the
next time the procedure is schedueld (I don't want to have
an EINTR or sort).
<P>

Thanks a lot.
<P>

</td></tr>
</table>
<P><NOBR>





</NOBR><BR>

<P>
<P>



  






<BR> 
 
<BR></BODY>
</HTML>
