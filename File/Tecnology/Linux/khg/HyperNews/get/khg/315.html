
<HTML>
<HEAD>
<TITLE>How can I prevent kernel RST responses on a transparently proxied raw socket?</TITLE>
<LINK rel="owner" href="mailto:">
<SCRIPT LANGUAGE="JavaScript">
<!-- hide this

function help(message) {
  self.status = message;
  return true;
}
// stop hiding -->
</SCRIPT>

</HEAD>
<BODY>
<strong>The
<a href="http://www.hypernews.org/HyperNews/get/hypernews.html">
HyperNews <a href="../khg.html">Linux KHG</a>
Discussion Pages</strong>
<hr>
<NOBR>





</NOBR><BR>
<H2><IMG src="../../../Icons/question.gif" ALT="Question:"
  WIDTH=15 HEIGHT=15
  ALIGN="bottom">
How can I prevent kernel RST responses on a transparently proxied raw socket?</H2>

<DL> <DD>
<NOBR>
<font size=+1><I>Forum:</I> <A HREF="../khg.html" >
 The Linux Kernel Hackers' Guide</A> </font><BR>
<I>Keywords:</I> SYN firewall transparent proxy raw socket <BR>
<I>Date:</I> Wed, 15 Jul 1998 06:10:50 GMT <BR>
<I>From:</I> Wesley Terpstra &lt;<A HREF="mailto:terpstra@unixg.ubc.ca" >terpstra@unixg.ubc.ca</A>&gt; <BR>

</NOBR>
</DD> </DL>

<P>
<table border cellpadding=5 cellspacing=0 
 width="100%" BGCOLOR="#FFFFFF">
 <tr><td>

I am trying to add to my firewall a utility which catches SYN requests, does not respond but establishes another network interface, and then repeats the SYN (spoofed) over the new interface thus giving an instant reponse when the link goes up.
<P>

The problem I'm having is that I can't figure out how to make the kernel NOT send the RST response to client SYNs. I can catch their SYNs fine and bring the link up.
<P>

What I've tried:
/sbin/ipfwadm -I -a accept -r 151 -S 192.168.2.0/24 -P tcp
/sbin/ipfwadm -I -a deny -P tcp -S 192.168.2.0/24 -D 192.168.2.254 151
<P>

192.168.2.254 is the firewall and 192.168.2.0/24 the subnet it lives on.
<P>

I *need* the rerouting rule or the raw socket doesn't detect the SYN requests. Interestingly, the socket catches the SYNs no matter where I bind it too as long as that firewall rule is in place...
<P>

How can I solve this problem w/o ... tweaking ... the kernel?
<P>

</td></tr>
</table>
<P><NOBR>





</NOBR><BR>

<P>
<P>



  






<BR> 
 
<BR></BODY>
</HTML>
